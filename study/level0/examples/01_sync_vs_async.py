"""
é˜¶æ®µ 0.1: åŒæ­¥ vs å¼‚æ­¥ - ç†è§£æ‰§è¡Œæ¨¡å¼çš„å·®å¼‚

å­¦ä¹ ç›®æ ‡ï¼š
1. ç†è§£åŒæ­¥ä»£ç çš„æ‰§è¡Œé¡ºåºï¼ˆä¸€è¡Œä¸€è¡Œæ‰§è¡Œï¼‰
2. ç†è§£å¼‚æ­¥ä»£ç çš„æ‰§è¡Œç‰¹ç‚¹ï¼ˆé‡åˆ°awaitå°±åˆ‡æ¢ï¼‰
3. ç›´è§‚æ„Ÿå—ä¸¤è€…çš„åŒºåˆ«

è¿è¡Œæ—¶é—´å¯¹æ¯”ï¼š
- åŒæ­¥ç‰ˆæœ¬ï¼šçº¦6ç§’ï¼ˆ2ç§’ + 2ç§’ + 2ç§’ï¼‰
- å¼‚æ­¥ç‰ˆæœ¬ï¼šçº¦2ç§’ï¼ˆ3ä¸ªä»»åŠ¡å¹¶å‘æ‰§è¡Œï¼‰

è¿è¡Œè¿™ä¸ªç¤ºä¾‹ï¼Œè§‚å¯Ÿè¾“å‡ºå’Œæ—¶é—´å·®å¼‚ï¼
"""

import asyncio
import time


# ============ åŒæ­¥ç‰ˆæœ¬ ============

def sync_task(name: str, delay: float) -> str:
    """åŒæ­¥ä»»åŠ¡ï¼šä¼šé˜»å¡æ‰§è¡Œ"""
    print(f"ğŸ”„ åŒæ­¥ä»»åŠ¡ {name} å¼€å§‹ï¼Œéœ€è¦ {delay} ç§’...")
    time.sleep(delay)  # é˜»å¡å¼ç­‰å¾…
    print(f"âœ… åŒæ­¥ä»»åŠ¡ {name} å®Œæˆï¼")
    return f"ä»»åŠ¡ {name} çš„ç»“æœ"


def run_sync():
    """åŒæ­¥æ‰§è¡Œï¼šæŒ‰é¡ºåºä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œ"""
    print("\n" + "="*50)
    print("ğŸ“Œ åŒæ­¥ç‰ˆæœ¬å¼€å§‹")
    print("="*50)

    start = time.time()

    # ä»»åŠ¡ä¼šæŒ‰é¡ºåºæ‰§è¡Œ
    result1 = sync_task("A", 2)
    result2 = sync_task("B", 2)
    result3 = sync_task("C", 2)

    end = time.time()

    print(f"\nğŸ¯ æ‰€æœ‰ä»»åŠ¡å®Œæˆ")
    print(f"â±ï¸  æ€»è€—æ—¶: {end - start:.2f} ç§’")
    print(f"ğŸ“¦ ç»“æœ: {result1}, {result2}, {result3}")


# ============ å¼‚æ­¥ç‰ˆæœ¬ ============

async def async_task(name: str, delay: float) -> str:
    """å¼‚æ­¥ä»»åŠ¡ï¼šé‡åˆ°awaitå°±è®©å‡ºæ§åˆ¶æƒ"""
    print(f"ğŸš€ å¼‚æ­¥ä»»åŠ¡ {name} å¼€å§‹ï¼Œéœ€è¦ {delay} ç§’...")
    await asyncio.sleep(delay)  # éé˜»å¡å¼ç­‰å¾…
    print(f"âœ… å¼‚æ­¥ä»»åŠ¡ {name} å®Œæˆï¼")
    return f"ä»»åŠ¡ {name} çš„ç»“æœ"


async def run_async():
    """å¼‚æ­¥æ‰§è¡Œï¼šå¹¶å‘æ‰§è¡Œå¤šä¸ªä»»åŠ¡"""
    print("\n" + "="*50)
    print("ğŸ“Œ å¼‚æ­¥ç‰ˆæœ¬å¼€å§‹")
    print("="*50)

    start = time.time()

    # ä¸‰ä¸ªä»»åŠ¡åŒæ—¶å‘èµ·ï¼Œå¹¶å‘æ‰§è¡Œ
    results = await asyncio.gather(
        async_task("A", 2),
        async_task("B", 2),
        async_task("C", 2),
    )

    end = time.time()

    print(f"\nğŸ¯ æ‰€æœ‰ä»»åŠ¡å®Œæˆ")
    print(f"â±ï¸  æ€»è€—æ—¶: {end - start:.2f} ç§’")
    print(f"ğŸ“¦ ç»“æœ: {results}")


# ============ ä¸»å‡½æ•° ============

def main():
    """è¿è¡Œå¯¹æ¯”å®éªŒ"""
    print("\n" + "="*50)
    print("ğŸ“ é˜¶æ®µ 0.1: åŒæ­¥ vs å¼‚æ­¥å¯¹æ¯”")
    print("="*50)

    # å…ˆè¿è¡ŒåŒæ­¥ç‰ˆæœ¬
    run_sync()

    # å†è¿è¡Œå¼‚æ­¥ç‰ˆæœ¬
    print("\n" + "â¬‡ï¸" * 25)
    asyncio.run(run_async())

    print("\n" + "="*50)
    print("ğŸ’¡ è§‚å¯Ÿè¦ç‚¹ï¼š")
    print("1. åŒæ­¥ç‰ˆæœ¬ï¼šä»»åŠ¡æŒ‰é¡ºåºæ‰§è¡Œï¼Œæ€»æ—¶é—´æ˜¯æ¯ä¸ªä»»åŠ¡æ—¶é—´ä¹‹å’Œ")
    print("2. å¼‚æ­¥ç‰ˆæœ¬ï¼šä»»åŠ¡å¹¶å‘æ‰§è¡Œï¼Œæ€»æ—¶é—´çº¦ç­‰äºæœ€æ…¢ä»»åŠ¡çš„æ—¶é—´")
    print("3. å¼‚æ­¥ç‰ˆæœ¬ä¸­ï¼Œä»»åŠ¡ä¸ä¼šäº’ç›¸ç­‰å¾…ï¼Œè€Œæ˜¯'åŒæ—¶'è¿›è¡Œ")
    print("="*50 + "\n")


if __name__ == "__main__":
    main()
