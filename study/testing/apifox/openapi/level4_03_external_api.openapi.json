{
  "openapi": "3.1.0",
  "info": {
    "title": "外部 API 集成示例",
    "description": "展示外部 API 调用的最佳实践",
    "version": "1.0.0"
  },
  "paths": {
    "/": {
      "get": {
        "summary": "Root",
        "description": "健康检查",
        "operationId": "root__get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/payments": {
      "post": {
        "summary": "Create Payment",
        "description": "创建支付\n\n特性：\n    - 重试策略\n    - 超时控制\n    - 幂等性保证",
        "operationId": "create_payment_payments_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PaymentRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaymentResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/weather": {
      "get": {
        "summary": "Get Weather",
        "description": "获取天气\n\n特性：\n    - 熔断器\n    - 缓存\n    - 服务降级",
        "operationId": "get_weather_weather_get",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/WeatherRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WeatherResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/circuit-breaker/state": {
      "get": {
        "summary": "Get Circuit Breaker State",
        "description": "获取熔断器状态",
        "operationId": "get_circuit_breaker_state_circuit_breaker_state_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/circuit-breaker/reset": {
      "post": {
        "summary": "Reset Circuit Breaker",
        "description": "重置熔断器",
        "operationId": "reset_circuit_breaker_circuit_breaker_reset_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "PaymentRequest": {
        "properties": {
          "amount": {
            "type": "number",
            "exclusiveMinimum": 0.0,
            "title": "Amount"
          },
          "currency": {
            "type": "string",
            "pattern": "^[A-Z]{3}$",
            "title": "Currency",
            "default": "USD"
          },
          "user_id": {
            "type": "integer",
            "title": "User Id"
          },
          "order_id": {
            "type": "integer",
            "title": "Order Id"
          }
        },
        "type": "object",
        "required": [
          "amount",
          "user_id",
          "order_id"
        ],
        "title": "PaymentRequest",
        "description": "支付请求"
      },
      "PaymentResponse": {
        "properties": {
          "payment_id": {
            "type": "string",
            "title": "Payment Id"
          },
          "status": {
            "type": "string",
            "title": "Status"
          },
          "amount": {
            "type": "number",
            "title": "Amount"
          },
          "currency": {
            "type": "string",
            "title": "Currency"
          },
          "processed_at": {
            "type": "string",
            "format": "date-time",
            "title": "Processed At"
          }
        },
        "type": "object",
        "required": [
          "payment_id",
          "status",
          "amount",
          "currency",
          "processed_at"
        ],
        "title": "PaymentResponse",
        "description": "支付响应"
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          },
          "input": {
            "title": "Input"
          },
          "ctx": {
            "type": "object",
            "title": "Context"
          }
        },
        "type": "object",
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError"
      },
      "WeatherRequest": {
        "properties": {
          "city": {
            "type": "string",
            "title": "City"
          },
          "country": {
            "type": "string",
            "maxLength": 2,
            "minLength": 2,
            "title": "Country",
            "default": "US"
          }
        },
        "type": "object",
        "required": [
          "city"
        ],
        "title": "WeatherRequest",
        "description": "天气查询请求"
      },
      "WeatherResponse": {
        "properties": {
          "city": {
            "type": "string",
            "title": "City"
          },
          "temperature": {
            "type": "number",
            "title": "Temperature"
          },
          "condition": {
            "type": "string",
            "title": "Condition"
          },
          "humidity": {
            "type": "integer",
            "title": "Humidity"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "title": "Timestamp"
          }
        },
        "type": "object",
        "required": [
          "city",
          "temperature",
          "condition",
          "humidity",
          "timestamp"
        ],
        "title": "WeatherResponse",
        "description": "天气响应"
      }
    }
  }
}